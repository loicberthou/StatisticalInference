---
title: "Statistical Inference Project - Part II"
subtitle: "Analysis  of the ToothGrowth data"
author: "Lo√Øc BERTHOU"
date: "August 19, 2015"
output: pdf_document
---

```{r, echo=FALSE, results='hide', message=FALSE}
set.seed(20150819)
library(ggplot2)
library(dplyr)
```

# Overview

This document is a basic analysis of the ToothGroth dataset provided in the R datasets packages.

# Introduction

Since we don't have any knowledge about this dataset, we will first perform an exploratory analysis to get a better sense of the type of data we will be dealing with.
Then we will perform a comparison of the tooth groth by supp and dose as requested.

# Exploratory data analysis

The first thing to do with the dataset is to check if there is any sort of documentation attached to it. 

```{r}
help("ToothGrowth")
```

The _str_ function returns some useful information.

```{r}
str(ToothGrowth)
```

Finally, I will draw a first plot of the scattered points.

```{r, fig.width=7, fig.height=4, echo=FALSE}
g <- ggplot(data=ToothGrowth, aes(x=dose, y=len))
g <- g + geom_point(aes(color=supp), size=5, alpha=.5)
g <- g + ggtitle("Figure 1 - Exploratory data analysis")
g
```

# Summary of the data

We have now a first idea of the data manipulated.
These numbers have been produced by a study on the effect of Vitamin C on guinea pigs and more precisely the length of their teeth.
The vitamin C has been administered either in the form of orange juice (represented "OJ"") or ascorbic acid (represented "VC"). Each form has been administered at 3 dose levels to 10 animals (60 different animals in total).

# Tooth growth comparison by supp and dose

We will compare the effects of the orange juice and ascorbic acid for each dose. In this experience, each measure has been taken on a different animal, so we can not infer a grouping by animal.

We will then compare the mean length progression between two doses and look at the confidence interval to make any conclusion.

## Orange Juice

### From dose 0.5 to 1.0

```{r, echo=FALSE}
g2 <- select(filter(ToothGrowth, supp=="OJ", dose==1.0), len)
g1 <- select(filter(ToothGrowth, supp=="OJ", dose==0.5), len)
confGroth <- t.test(g2, g1, paired = FALSE)$conf.int
```
The range of values for the average growth with a confidence interval of 95% is between `r confGroth[1]` and `r confGroth[2]`.

### From dose 1.0 to 2.0

```{r, echo=FALSE}
g2 <- select(filter(ToothGrowth, supp=="OJ", dose==2.0), len)
g1 <- select(filter(ToothGrowth, supp=="OJ", dose==1.0), len)
confGroth <- t.test(g2, g1, paired = FALSE)$conf.int
```
The range of values for the average growth with a confidence interval of 95% is between `r confGroth[1]` and `r confGroth[2]`.

## Ascorbic Acid
### From dose 0.5 to 1.0
```{r, echo=FALSE}
g2 <- select(filter(ToothGrowth, supp=="VC", dose==1.0), len)
g1 <- select(filter(ToothGrowth, supp=="VC", dose==0.5), len)
confGroth <- t.test(g2, g1, paired = FALSE)$conf.int
```
The range of values for the average growth with a confidence interval of 95% is between `r confGroth[1]` and `r confGroth[2]`.

### From dose 1.0 to 2.0
```{r, echo=FALSE}
g2 <- select(filter(ToothGrowth, supp=="VC", dose==2.0), len)
g1 <- select(filter(ToothGrowth, supp=="VC", dose==1.0), len)
confGroth <- t.test(g2, g1, paired = FALSE)$conf.int
```
The range of values for the average growth with a confidence interval of 95% is between `r confGroth[1]` and `r confGroth[2]`.

```{r, fig.width=7, fig.height=4, echo=FALSE}
my_ci <- function(x) data.frame(y=mean(x), ymin=mean(x) - 2 * sd(x), ymax=mean(x) + 2 * sd(x))

g <- ggplot(data=ToothGrowth, aes(x=dose, y=len))
g <- g + geom_point(aes(color=supp), size=5, alpha=.5, position = position_jitter(w = 0.05, h = 0))
g <- g + stat_summary(aes(color=supp), fun.data="my_ci", geom="smooth")
g <- g + facet_wrap(~supp)
g <- g + ggtitle("Figure 2 - Tooth groth comparison")
g
```

# Conclusion

TODO
